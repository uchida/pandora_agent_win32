# Fichero de configuracion base de agentes de Pandora
# Base config file for Pandora FMS Windows Agent
# Version 1.3.0
# (c) 2006 Esteban Sanchez
# (c) 2006 Artica Soluciones Tecnologicas
# This program is Free Software, you can redistribute it and/or modify it 
# under the terms of the GNU General Public Licence as published by the Free Software
# Foundation; either version 2 of the Licence or any later version.
# This program is distributed in the hope that it will be useful, but 
# WITHOUT ANY WARRANTY, without ever the implied warranty of MERCHANTABILITY or FITNESS 
# FOR A PARTICULAR PURPOSE.

# General Parameters
# ==================

server_ip 192.168.50.100
server_path /var/spool/pandora/data_in
temporal "C:\windows\temp"
interval 300
agent_name caprica
#debug 1

# Module Definition
# =================


# Counting OpenedConnections (check the language string)
module_begin
module_name OpenNetConnections
module_type generic_data
module_exec netstat -na | grep ESTAB | wc -l | tr -d " "
module_description Open Connections (interval 2)
module_interval 2
module_end

# Is Schedule service running ?
module_begin
module_name ServicioProg
module_type generic_proc
module_service Schedule
module_description Schedule Service
module_end

# Is Eventlog service running ?
module_begin
module_name ServicioReg
module_type generic_proc
module_service Eventlog
module_description Eventlog Service
module_end

# Is lsass.exe process alive ?
module_begin
module_name Proc_lsass
module_type generic_proc
module_proc lsass.exe
module_description LSASS Process
module_end

# Is lsass.exe process alive ?
module_begin
module_name Proc_winlogon
module_type generic_proc
module_proc winlogon.exe
module_description Winlogon
module_end

# Is lsass.exe process alive ?
module_begin
module_name Proc_cmd
module_type generic_proc
module_proc cmd.exe
module_description cmd
module_end

# Received packets
module_begin
module_name ReceivedPackets
module_type generic_data
module_exec netstat -s | grep "Packets Received" | tr -d " " | cut -f 2 -d "=" | tr -d "\n"
module_description Received packets (interval 2)
module_end

# Free space on disk
module_begin
module_name FreeDiskC
module_type generic_data
module_freedisk C:
module_description Free space on drive C:
module_end

# CPU usage percentage
module_begin
module_name CPUUse0
module_type generic_data
module_cpuusage 0
module_description CPU#0 usage
module_end

module_begin
module_name FreeMemory
module_type generic_data
module_freememory
module_description Amount of free memory.
module_end

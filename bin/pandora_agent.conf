# Fichero de configuracion base de agentes de Pandora
# Base config file for Pandora agents
# Version 1.2 Beta 2
# (c) 2006 Esteban Sanchez
# (c) 2006 Artica Soluciones Tecnologicas
# This program is Free Software, you can redistribute it and/or modify it 
# under the terms of the GNU General Public Licence as published by the Free Software
# Foundation; either version 2 of the Licence or any later version.
# This program is distributed in the hope that it will be useful, but 
# WITHOUT ANY WARRANTY, without ever the implied warranty of MERCHANTABILITY or FITNESS 
# FOR A PARTICULAR PURPOSE.

# General Parameters
# ==================

server_ip 127.0.0.1
server_path /opt/pandora_server/data_in
temporal "D:\temp"
interval 1
agent_name localhost

# Module Definition
# =================


# Counting OpenedConnections (check the language string)
module_begin
module_name OpenNetConnections
module_type generic_data
module_exec netstat -na | grep ESTAB | wc -l | tr -d " "
module_description Conexiones abiertas (interval 2)
module_interval 2
module_end

# Is Schedule service running ?
module_begin
module_name ServicioProg
module_type generic_proc
module_service Schedule
module_description Servicio Programador de tareas
module_end

# Is Eventlog service running ?
module_begin
module_name ServicioReg
module_type generic_proc
module_service Eventlog
module_description Servicio Registro de sucesos
module_end

# Is lsass.exe process alive ?
module_begin
module_name Proc_lsass
module_type generic_proc
module_proc "lsass.exe"
module_description Proceso LSASS.exe
module_end

# Received packets
module_begin
module_name ReceivedPackets
module_type generic_data
module_exec netstat -s | grep  "Paquetes recibidos  "| tr -d " " | cut -f 2 -d "=" | tr -d "\n"
module_description Conexiones abiertas (interval 2)
module_end

# Free space on disk
module_begin
module_name FreeDiskC
module_type generic_data
module_freedisk C:
module_description Free space on drive C:
module_end

# CPU usage percentage
module_begin
module_name CPUUse0
module_type generic_data
module_cpuusage 0
module_description CPU#0 usage
module_end

module_begin
module_name FreeMemory
module_type generic_data
module_freememory
module_description Amount of free memory.
module_end


